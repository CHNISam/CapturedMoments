"use strict";(self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[]).push([[694],{25694:(e,t,l)=>{l.r(t),l.d(t,{default:()=>nt});var a=l(20641),i=l(90033),s=l(53751);const o={key:0,class:"mobile-nav"},n={class:"nav-list mobile"},d={key:1,class:"mobile-detail"},r={class:"detail-header"},c={class:"detail-title"},u={class:"settings-content"},p={class:"settings-group setting-group-card"},m={class:"setting-item"},g={key:0,viewBox:"0 0 24 24"},k={key:1,viewBox:"0 0 24 24"},v={class:"setting-item"},h={class:"settings-group setting-group-card"},b={class:"setting-item"},w={class:"setting-item rename-item"},f={class:"setting-item"},L=["src"],S={class:"setting-item"},C={class:"settings-group setting-group-card"},B={class:"setting-item"},y={class:"settings-group setting-group-card"},M={class:"setting-item"},U={class:"settings-group setting-group-card"},_={class:"setting-item"},A={class:"settings-nav"},I={class:"nav-list"},x={class:"settings-content"},F={class:"desktop-detail-header"},E={class:"settings-group setting-group-card"},$={class:"setting-item"},R={key:0,viewBox:"0 0 24 24"},O={key:1,viewBox:"0 0 24 24"},V={class:"setting-item"},X={class:"settings-group setting-group-card"},W={class:"setting-item"},D={class:"setting-item rename-item"},N={class:"setting-item"},P=["src"],G={class:"setting-item"},K={class:"settings-group setting-group-card"},J={class:"setting-item"},z={class:"settings-group setting-group-card"},Q={class:"setting-item"},T={class:"settings-group setting-group-card"},j={class:"setting-item"},q={class:"box",style:{"min-width":"360px","max-width":"480px"}},H={style:{"margin-bottom":"24px"}},Y={style:{"text-align":"right",gap:"8px",display:"flex","justify-content":"flex-end"}},Z={class:"setting-list"},ee={class:"setting-item"},te={class:"upload-btn"},le={class:"setting-item"},ae={class:"setting-item"},ie={class:"setting-item"};function se(e,t,l,se,oe,ne){const de=(0,a.g2)("IconVisual"),re=(0,a.g2)("IconProfile"),ce=(0,a.g2)("IconAssistant"),ue=(0,a.g2)("IconPublish"),pe=(0,a.g2)("IconAdmin"),me=(0,a.g2)("GhostBtn"),ge=(0,a.g2)("ToggleSwitch"),ke=(0,a.g2)("AdminControls"),ve=(0,a.g2)("BaseModal");return(0,a.uX)(),(0,a.CE)("section",{id:"settings",class:(0,i.C4)(["settings-container",{mobile:oe.isMobile}])},[oe.isMobile?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[null===oe.activeSection?((0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("ul",n,[(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"visual"===oe.activeSection}]),onClick:t[0]||(t[0]=e=>ne.toggleSection("visual"))},[(0,a.bF)(de,{class:"nav-icon"}),t[35]||(t[35]=(0,a.Lk)("span",{class:"nav-label"},"视觉 / 界面",-1)),t[36]||(t[36]=(0,a.Lk)("svg",{class:"chevron-icon",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,a.Lk)("path",{d:"M9 18l6-6-6-6"})],-1))],2),(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"profile"===oe.activeSection}]),onClick:t[1]||(t[1]=e=>ne.toggleSection("profile"))},[(0,a.bF)(re,{class:"nav-icon"}),t[37]||(t[37]=(0,a.Lk)("span",{class:"nav-label"},"个人资料",-1)),t[38]||(t[38]=(0,a.Lk)("svg",{class:"chevron-icon",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,a.Lk)("path",{d:"M9 18l6-6-6-6"})],-1))],2),(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"assistant"===oe.activeSection}]),onClick:t[2]||(t[2]=e=>ne.toggleSection("assistant"))},[(0,a.bF)(ce,{class:"nav-icon"}),t[39]||(t[39]=(0,a.Lk)("span",{class:"nav-label"},"交互助手",-1)),t[40]||(t[40]=(0,a.Lk)("svg",{class:"chevron-icon",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,a.Lk)("path",{d:"M9 18l6-6-6-6"})],-1))],2),(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"publish"===oe.activeSection}]),onClick:t[3]||(t[3]=e=>ne.toggleSection("publish"))},[(0,a.bF)(ue,{class:"nav-icon"}),t[41]||(t[41]=(0,a.Lk)("span",{class:"nav-label"},"发布 与 上传",-1)),t[42]||(t[42]=(0,a.Lk)("svg",{class:"chevron-icon",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,a.Lk)("path",{d:"M9 18l6-6-6-6"})],-1))],2),ne.isAdmin?((0,a.uX)(),(0,a.CE)("li",{key:0,class:(0,i.C4)(["nav-item",{active:"admin"===oe.activeSection}]),onClick:t[4]||(t[4]=e=>ne.toggleSection("admin"))},[(0,a.bF)(pe,{class:"nav-icon"}),t[43]||(t[43]=(0,a.Lk)("span",{class:"nav-label"},"管理员",-1)),t[44]||(t[44]=(0,a.Lk)("svg",{class:"chevron-icon",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,a.Lk)("path",{d:"M9 18l6-6-6-6"})],-1))],2)):(0,a.Q3)("",!0)])])):((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("header",r,[(0,a.Lk)("button",{class:"back-btn",onClick:t[5]||(t[5]=e=>oe.activeSection=null),"aria-label":"返回"},t[45]||(t[45]=[(0,a.Lk)("svg",{class:"icon-back",viewBox:"0 0 24 24",fill:"none",stroke:"#fff","stroke-width":"2.75","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.Lk)("path",{d:"M15 18l-6-6 6-6"})],-1)])),(0,a.Lk)("h2",c,(0,i.v_)(ne.sectionTitleMap[oe.activeSection]),1),t[46]||(t[46]=(0,a.Lk)("span",{class:"header-spacer"},null,-1))]),(0,a.Lk)("section",u,[(0,a.bo)((0,a.Lk)("ul",p,[(0,a.Lk)("li",m,[t[49]||(t[49]=(0,a.Lk)("span",null,"主题模式",-1)),(0,a.bF)(me,{disabled:"",title:"已锁定为深色模式"},{default:(0,a.k6)((()=>["light"===l.theme?((0,a.uX)(),(0,a.CE)("svg",g,t[47]||(t[47]=[(0,a.Lk)("circle",{cx:"12",cy:"12",r:"5"},null,-1)]))):((0,a.uX)(),(0,a.CE)("svg",k,t[48]||(t[48]=[(0,a.Lk)("path",{d:"M21 12.8A9 9 0 1111.2 3 7 7 0 0021 12.8z"},null,-1)])))])),_:1})]),(0,a.Lk)("li",v,[t[51]||(t[51]=(0,a.Lk)("span",null,"背景设置",-1)),(0,a.bF)(me,{onClick:t[6]||(t[6]=e=>oe.showBgModal=!0)},{default:(0,a.k6)((()=>t[50]||(t[50]=[(0,a.eW)("打开")]))),_:1})])],512),[[s.aG,"visual"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",h,[(0,a.Lk)("li",b,[t[53]||(t[53]=(0,a.Lk)("span",null,"账号 / 安全",-1)),(0,a.bF)(me,{onClick:t[7]||(t[7]=t=>e.$emit("open-password-modal"))},{default:(0,a.k6)((()=>t[52]||(t[52]=[(0,a.eW)("更改密码")]))),_:1})]),(0,a.Lk)("li",w,[t[54]||(t[54]=(0,a.Lk)("span",null,"我的昵称",-1)),(0,a.bF)(me,{onClick:t[8]||(t[8]=e=>oe.showRenameModal=!0)},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(l.localDisplayName||"设置昵称"),1)])),_:1})]),(0,a.Lk)("li",f,[t[55]||(t[55]=(0,a.Lk)("span",null,"头像：",-1)),(0,a.Lk)("input",{type:"file",accept:"image/*",onChange:t[9]||(t[9]=(...e)=>ne.onAvatarChange&&ne.onAvatarChange(...e))},null,32),oe.userStore&&oe.userStore.avatarMap&&oe.userStore.avatarMap[l.currentUser]?((0,a.uX)(),(0,a.CE)("img",{key:0,src:oe.userStore.avatarMap[l.currentUser],alt:"头像预览",style:{width:"60px",height:"60px","border-radius":"50%","margin-left":"8px"}},null,8,L)):(0,a.Q3)("",!0)]),(0,a.Lk)("li",S,[t[57]||(t[57]=(0,a.Lk)("span",null,"勋章中心",-1)),(0,a.bF)(me,{onClick:t[10]||(t[10]=t=>e.$emit("open-badge-modal"))},{default:(0,a.k6)((()=>t[56]||(t[56]=[(0,a.eW)("更换勋章")]))),_:1})])],512),[[s.aG,"profile"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",C,[(0,a.Lk)("li",B,[t[58]||(t[58]=(0,a.Lk)("span",null,"AI",-1)),(0,a.bF)(ge,{modelValue:l.llmEnabled,"onUpdate:modelValue":t[11]||(t[11]=t=>e.$emit("update:llmEnabled",t))},null,8,["modelValue"])])],512),[[s.aG,"assistant"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",y,[(0,a.Lk)("li",M,[t[59]||(t[59]=(0,a.Lk)("span",null,"图片嵌入正文",-1)),(0,a.bF)(ge,{modelValue:"inline"===l.imageInsertMode,"onUpdate:modelValue":t[12]||(t[12]=t=>e.$emit("update:imageInsertMode",t?"inline":"preview"))},null,8,["modelValue"])])],512),[[s.aG,"publish"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",U,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.allowedUids,(t=>((0,a.uX)(),(0,a.CE)("li",{class:"setting-item",key:t},[(0,a.Lk)("span",null,(0,i.v_)(t),1),(0,a.bF)(ke,{uid:t,onResetPassword:t=>e.$emit("reset-password",t),onRemoveAllowedUid:t=>e.$emit("remove-allowed-uid",t),onOpenAdminPwdModal:t=>e.$emit("open-admin-pwd-modal",t)},null,8,["uid","onResetPassword","onRemoveAllowedUid","onOpenAdminPwdModal"])])))),128)),(0,a.Lk)("li",_,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>oe.newAdminUid=e),placeholder:"新 UID",class:"rename-input",style:{background:"#1f1f1f",color:"#e0e0e0",border:"1px solid #444","border-radius":"4px",padding:"6px 8px",width:"60%"}},null,512),[[s.Jo,oe.newAdminUid]]),(0,a.bF)(me,{onClick:ne.emitAddUid},{default:(0,a.k6)((()=>t[60]||(t[60]=[(0,a.eW)("新增")]))),_:1},8,["onClick"])])],512),[[s.aG,"admin"===oe.activeSection&&ne.isAdmin]])])]))],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("aside",A,[(0,a.Lk)("ul",I,[(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"visual"===oe.activeSection}]),onClick:t[14]||(t[14]=e=>ne.toggleSection("visual"))},[(0,a.bF)(de,{class:"nav-icon"}),t[61]||(t[61]=(0,a.Lk)("span",{class:"nav-label"},"视觉 / 界面",-1))],2),(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"profile"===oe.activeSection}]),onClick:t[15]||(t[15]=e=>ne.toggleSection("profile"))},[(0,a.bF)(re,{class:"nav-icon"}),t[62]||(t[62]=(0,a.Lk)("span",{class:"nav-label"},"个人资料",-1))],2),(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"assistant"===oe.activeSection}]),onClick:t[16]||(t[16]=e=>ne.toggleSection("assistant"))},[(0,a.bF)(ce,{class:"nav-icon"}),t[63]||(t[63]=(0,a.Lk)("span",{class:"nav-label"},"交互助手",-1))],2),(0,a.Lk)("li",{class:(0,i.C4)(["nav-item",{active:"publish"===oe.activeSection}]),onClick:t[17]||(t[17]=e=>ne.toggleSection("publish"))},[(0,a.bF)(ue,{class:"nav-icon"}),t[64]||(t[64]=(0,a.Lk)("span",{class:"nav-label"},"发布 与 上传",-1))],2),ne.isAdmin?((0,a.uX)(),(0,a.CE)("li",{key:0,class:(0,i.C4)(["nav-item",{active:"admin"===oe.activeSection}]),onClick:t[18]||(t[18]=e=>ne.toggleSection("admin"))},[(0,a.bF)(pe,{class:"nav-icon"}),t[65]||(t[65]=(0,a.Lk)("span",{class:"nav-label"},"管理员",-1))],2)):(0,a.Q3)("",!0)])]),(0,a.Lk)("section",x,[(0,a.Lk)("header",F,(0,i.v_)(ne.sectionTitleMap[oe.activeSection]),1),(0,a.bo)((0,a.Lk)("ul",E,[(0,a.Lk)("li",$,[t[68]||(t[68]=(0,a.Lk)("span",null,"主题模式",-1)),(0,a.bF)(me,{disabled:"",title:"已锁定为深色模式"},{default:(0,a.k6)((()=>["light"===l.theme?((0,a.uX)(),(0,a.CE)("svg",R,t[66]||(t[66]=[(0,a.Lk)("circle",{cx:"12",cy:"12",r:"5"},null,-1)]))):((0,a.uX)(),(0,a.CE)("svg",O,t[67]||(t[67]=[(0,a.Lk)("path",{d:"M21 12.8A9 9 0 1111.2 3 7 7 0 0021 12.8z"},null,-1)])))])),_:1})]),(0,a.Lk)("li",V,[t[70]||(t[70]=(0,a.Lk)("span",null,"背景设置",-1)),(0,a.bF)(me,{onClick:t[19]||(t[19]=e=>oe.showBgModal=!0)},{default:(0,a.k6)((()=>t[69]||(t[69]=[(0,a.eW)("打开")]))),_:1})])],512),[[s.aG,"visual"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",X,[(0,a.Lk)("li",W,[t[72]||(t[72]=(0,a.Lk)("span",null,"账号 / 安全",-1)),(0,a.bF)(me,{onClick:t[20]||(t[20]=t=>e.$emit("open-password-modal"))},{default:(0,a.k6)((()=>t[71]||(t[71]=[(0,a.eW)("更改密码")]))),_:1})]),(0,a.Lk)("li",D,[t[73]||(t[73]=(0,a.Lk)("span",null,"我的昵称",-1)),(0,a.bF)(me,{onClick:t[21]||(t[21]=e=>oe.showRenameModal=!0)},{default:(0,a.k6)((()=>[(0,a.eW)((0,i.v_)(l.localDisplayName||"设置昵称"),1)])),_:1})]),(0,a.Lk)("li",N,[t[74]||(t[74]=(0,a.Lk)("span",null,"头像：",-1)),(0,a.Lk)("input",{type:"file",accept:"image/*",onChange:t[22]||(t[22]=(...e)=>ne.onAvatarChange&&ne.onAvatarChange(...e))},null,32),oe.userStore&&oe.userStore.avatarMap&&oe.userStore.avatarMap[l.currentUser]?((0,a.uX)(),(0,a.CE)("img",{key:0,src:oe.userStore.avatarMap[l.currentUser],alt:"头像预览",style:{width:"60px",height:"60px","border-radius":"50%","margin-left":"8px"}},null,8,P)):(0,a.Q3)("",!0)]),(0,a.Lk)("li",G,[t[76]||(t[76]=(0,a.Lk)("span",null,"勋章中心",-1)),(0,a.bF)(me,{onClick:t[23]||(t[23]=t=>e.$emit("open-badge-modal"))},{default:(0,a.k6)((()=>t[75]||(t[75]=[(0,a.eW)("更换勋章")]))),_:1})])],512),[[s.aG,"profile"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",K,[(0,a.Lk)("li",J,[t[77]||(t[77]=(0,a.Lk)("span",null,"AI",-1)),(0,a.bF)(ge,{modelValue:l.llmEnabled,"onUpdate:modelValue":t[24]||(t[24]=t=>e.$emit("update:llmEnabled",t))},null,8,["modelValue"])])],512),[[s.aG,"assistant"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",z,[(0,a.Lk)("li",Q,[t[78]||(t[78]=(0,a.Lk)("span",null,"图片嵌入正文",-1)),(0,a.bF)(ge,{modelValue:"inline"===l.imageInsertMode,"onUpdate:modelValue":t[25]||(t[25]=t=>e.$emit("update:imageInsertMode",t?"inline":"preview"))},null,8,["modelValue"])])],512),[[s.aG,"publish"===oe.activeSection]]),(0,a.bo)((0,a.Lk)("ul",T,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.allowedUids,(t=>((0,a.uX)(),(0,a.CE)("li",{class:"setting-item",key:t},[(0,a.Lk)("span",null,(0,i.v_)(t),1),(0,a.bF)(ke,{uid:t,onResetPassword:t=>e.$emit("reset-password",t),onRemoveAllowedUid:t=>e.$emit("remove-allowed-uid",t),onOpenAdminPwdModal:t=>e.$emit("open-admin-pwd-modal",t)},null,8,["uid","onResetPassword","onRemoveAllowedUid","onOpenAdminPwdModal"])])))),128)),(0,a.Lk)("li",j,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[26]||(t[26]=e=>oe.newAdminUid=e),placeholder:"新 UID",class:"rename-input",style:{background:"#1f1f1f",color:"#e0e0e0",border:"1px solid #444","border-radius":"4px",padding:"6px 8px",width:"60%"}},null,512),[[s.Jo,oe.newAdminUid]]),(0,a.bF)(me,{onClick:ne.emitAddUid},{default:(0,a.k6)((()=>t[79]||(t[79]=[(0,a.eW)("新增")]))),_:1},8,["onClick"])])],512),[[s.aG,"admin"===oe.activeSection&&ne.isAdmin]])])],64)),((0,a.uX)(),(0,a.Wv)(a.Im,{to:"body"},[oe.showRenameModal?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"modal show",onClick:t[30]||(t[30]=(0,s.D$)((e=>oe.showRenameModal=!1),["self"]))},[(0,a.Lk)("div",q,[(0,a.Lk)("span",{class:"close",onClick:t[27]||(t[27]=e=>oe.showRenameModal=!1)},"×"),t[82]||(t[82]=(0,a.Lk)("h3",{style:{"margin-bottom":"16px"}},"修改昵称",-1)),(0,a.Lk)("div",H,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[28]||(t[28]=e=>oe.renameDraft=e),placeholder:"输入新的 昵称",style:{width:"100%",padding:"8px",border:"1px solid #444","border-radius":"4px",background:"#1f1f1f",color:"#e0e0e0"}},null,512),[[s.Jo,oe.renameDraft]])]),(0,a.Lk)("div",Y,[(0,a.bF)(me,{onClick:t[29]||(t[29]=e=>oe.showRenameModal=!1)},{default:(0,a.k6)((()=>t[80]||(t[80]=[(0,a.eW)("取消")]))),_:1}),(0,a.bF)(me,{onClick:ne.confirmRename},{default:(0,a.k6)((()=>t[81]||(t[81]=[(0,a.eW)("确定")]))),_:1},8,["onClick"])])])])):(0,a.Q3)("",!0)])),(0,a.bF)(ve,{modelValue:oe.showBgModal,"onUpdate:modelValue":t[34]||(t[34]=e=>oe.showBgModal=e),title:"背景设置",maxWidth:"480px"},{footer:(0,a.k6)((({close:e})=>[(0,a.bF)(me,{onClick:ne.cancelBg},{default:(0,a.k6)((()=>t[89]||(t[89]=[(0,a.eW)("取消")]))),_:1},8,["onClick"]),(0,a.bF)(me,{onClick:ne.confirmBg},{default:(0,a.k6)((()=>t[90]||(t[90]=[(0,a.eW)("完成")]))),_:1},8,["onClick"])])),default:(0,a.k6)((()=>[(0,a.Lk)("ul",Z,[(0,a.Lk)("li",ee,[t[84]||(t[84]=(0,a.Lk)("span",null,"上传背景",-1)),(0,a.Lk)("label",te,[(0,a.bF)(me,null,{default:(0,a.k6)((()=>t[83]||(t[83]=[(0,a.eW)("上传图片")]))),_:1}),(0,a.Lk)("input",{type:"file",accept:"image/*",onChange:t[31]||(t[31]=(...e)=>ne.onBgUpload&&ne.onBgUpload(...e)),style:{display:"none"}},null,32)])]),(0,a.Lk)("li",le,[t[85]||(t[85]=(0,a.Lk)("span",null,"背景透明度",-1)),(0,a.bo)((0,a.Lk)("input",{type:"range",min:"0",max:"1",step:"0.05","onUpdate:modelValue":t[32]||(t[32]=e=>oe.draftOpacity=e)},null,512),[[s.Jo,oe.draftOpacity,void 0,{number:!0}]])]),(0,a.Lk)("li",ae,[t[86]||(t[86]=(0,a.Lk)("span",null,"背景模糊",-1)),(0,a.bo)((0,a.Lk)("input",{type:"range",min:"0",max:"20",step:"1","onUpdate:modelValue":t[33]||(t[33]=e=>oe.draftBlur=e)},null,512),[[s.Jo,oe.draftBlur,void 0,{number:!0}]])]),(0,a.Lk)("li",ie,[t[88]||(t[88]=(0,a.Lk)("span",null,"清除背景",-1)),(0,a.bF)(me,{onClick:ne.clearBg},{default:(0,a.k6)((()=>t[87]||(t[87]=[(0,a.eW)("清除背景")]))),_:1},8,["onClick"])])])])),_:1},8,["modelValue"])],2)}const oe=["disabled"],ne={__name:"GhostBtn",props:{disabled:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:t}){const l=e,i=t;function s(e){l.disabled||i("click",e)}return(t,l)=>((0,a.uX)(),(0,a.CE)("button",{class:"ghost-btn",disabled:e.disabled,onClick:s},[(0,a.RG)(t.$slots,"default")],8,oe))}};var de=l(66262);const re=(0,de.A)(ne,[["__scopeId","data-v-35ff1ca4"]]),ce=re,ue={class:"toggle-switch"},pe=["checked"],me={__name:"ToggleSwitch",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const l=t;function i(e){l("update:modelValue",e.target.checked)}return(t,l)=>((0,a.uX)(),(0,a.CE)("label",ue,[(0,a.Lk)("input",{type:"checkbox",checked:e.modelValue,onChange:i},null,40,pe),l[0]||(l[0]=(0,a.Lk)("span",{class:"slider"},null,-1))]))}},ge=(0,de.A)(me,[["__scopeId","data-v-6a800acf"]]),ke=ge,ve={class:"admin-controls"};function he(e,t,l,i,s,o){const n=(0,a.g2)("GhostBtn");return(0,a.uX)(),(0,a.CE)("div",ve,[(0,a.bF)(n,{onClick:t[0]||(t[0]=t=>e.$emit("resetPassword",l.uid))},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("重置密码")]))),_:1}),(0,a.bF)(n,{onClick:t[1]||(t[1]=t=>e.$emit("removeAllowedUid",l.uid))},{default:(0,a.k6)((()=>t[4]||(t[4]=[(0,a.eW)("删除")]))),_:1}),(0,a.bF)(n,{onClick:t[2]||(t[2]=t=>e.$emit("openAdminPwdModal",l.uid))},{default:(0,a.k6)((()=>t[5]||(t[5]=[(0,a.eW)("打开密码弹窗")]))),_:1})])}const be={name:"AdminControls",props:{uid:{type:[String,Number],required:!0}},emits:["resetPassword","removeAllowedUid","openAdminPwdModal"]},we=(0,de.A)(be,[["render",he],["__scopeId","data-v-2fd4d5a4"]]),fe=we,Le={key:0,class:"modal-title"},Se={class:"modal-body"},Ce={class:"modal-footer"},Be={__name:"BaseModal",props:{modelValue:Boolean,title:String,maxWidth:{type:String,default:"480px"}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,o=t,n=(0,a.EW)({get:()=>l.modelValue,set:e=>o("update:modelValue",e)}),d=()=>n.value=!1,r=(0,a.EW)((()=>({width:"90vw",maxWidth:l.maxWidth,padding:"24px",position:"relative"})));return(t,l)=>((0,a.uX)(),(0,a.Wv)(a.Im,{to:"body"},[n.value?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"modal show",onClick:(0,s.D$)(d,["self"])},[(0,a.Lk)("div",{class:"box",style:(0,i.Tr)(r.value)},[(0,a.Lk)("span",{class:"close",onClick:d},"×"),e.title?((0,a.uX)(),(0,a.CE)("h3",Le,(0,i.v_)(e.title),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",Se,[(0,a.RG)(t.$slots,"default")]),(0,a.Lk)("div",Ce,[(0,a.RG)(t.$slots,"footer",{close:d})])],4)])):(0,a.Q3)("",!0)]))}},ye=Be,Me=ye;var Ue=l(93468);const _e={class:"icon-svg",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"};function Ae(e,t){return(0,a.uX)(),(0,a.CE)("svg",_e,t[0]||(t[0]=[(0,a.Lk)("path",{d:"M9.4 11c.2-.7.6-1.4 1.1-2.1 1-1.4 2.5-2.4 4.2-2.8M12 2a10 10 0 1 0 10 10c0-2-.6-3.9-1.7-5.5"},null,-1)]))}const Ie={},xe=(0,de.A)(Ie,[["render",Ae],["__scopeId","data-v-6cbbaf25"]]),Fe=xe,Ee={class:"icon-svg",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"};function $e(e,t){return(0,a.uX)(),(0,a.CE)("svg",Ee,t[0]||(t[0]=[(0,a.Lk)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10z"},null,-1)]))}const Re={},Oe=(0,de.A)(Re,[["render",$e],["__scopeId","data-v-7f912b18"]]),Ve=Oe,Xe={class:"icon-svg",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"};function We(e,t){return(0,a.uX)(),(0,a.CE)("svg",Xe,t[0]||(t[0]=[(0,a.Lk)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4z"},null,-1),(0,a.Lk)("path",{d:"M4 20v-2c0-2.21 3.58-4 8-4s8 1.79 8 4v2"},null,-1)]))}const De={},Ne=(0,de.A)(De,[["render",We],["__scopeId","data-v-34374662"]]),Pe=Ne,Ge={class:"icon-svg",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"};function Ke(e,t){return(0,a.uX)(),(0,a.CE)("svg",Ge,t[0]||(t[0]=[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"},null,-1),(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 10l5-5m0 0l5 5m-5-5v12"},null,-1)]))}const Je={},ze=(0,de.A)(Je,[["render",Ke],["__scopeId","data-v-62b09517"]]),Qe=ze,Te={class:"icon-svg",viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"};function je(e,t){return(0,a.uX)(),(0,a.CE)("svg",Te,t[0]||(t[0]=[(0,a.Lk)("path",{d:"M2.5 21.5l2-2 4-4L6 15l-4 4v2.5h2.5z"},null,-1),(0,a.Lk)("path",{d:"M6 15l9-9 3 3-9 9"},null,-1),(0,a.Lk)("path",{d:"M14.5 5.5l3.5-3.5 3 3-3.5 3.5"},null,-1)]))}const qe={},He=(0,de.A)(qe,[["render",je],["__scopeId","data-v-f918d210"]]),Ye=He,Ze={name:"SettingsPanel",components:{GhostBtn:ce,ToggleSwitch:ke,AdminControls:fe,BaseModal:Me,IconVisual:Ye,IconProfile:Pe,IconAssistant:Ve,IconPublish:Qe,IconAdmin:Fe},emits:["update:theme","update:bgSrc","update:bgOpacity","update:bgBlur","update:imageInsertMode","update:llmEnabled","update:localDisplayName","open-password-modal","open-badge-modal","reset-password","add-allowed-uid","remove-allowed-uid","open-admin-pwd-modal"],props:{theme:String,bgOpacity:Number,bgBlur:Number,bgSrc:String,imageInsertMode:String,llmEnabled:Boolean,localDisplayName:String,allowedUids:Array,currentUser:[String,Number],adminUid:[String,Number]},data(){return{activeSection:"visual",isMobile:!1,newAdminUid:"",showRenameModal:!1,renameDraft:this.localDisplayName||"",showBgModal:!1,origBgSrc:this.bgSrc,origOpacity:this.bgOpacity,origBlur:this.bgBlur,draftBgSrc:this.bgSrc,draftOpacity:this.bgOpacity,draftBlur:this.bgBlur,userStore:null}},computed:{isAdmin(){return String(this.currentUser)===String(this.adminUid)},sectionTitleMap(){return{visual:"视觉 / 界面",profile:"个人资料",assistant:"交互助手",publish:"发布 与 上传",admin:"管理员"}}},watch:{showBgModal(e){e&&(this.origBgSrc=this.bgSrc,this.origOpacity=this.bgOpacity,this.origBlur=this.bgBlur,this.draftBgSrc=this.bgSrc,this.draftOpacity=this.bgOpacity,this.draftBlur=this.bgBlur)},draftBgSrc(e){this.showBgModal&&this.$emit("update:bgSrc",e)},draftOpacity(e){this.showBgModal&&this.$emit("update:bgOpacity",e)},draftBlur(e){this.showBgModal&&this.$emit("update:bgBlur",e)}},mounted(){window.addEventListener("resize",this.updateMobile,{passive:!0}),this.updateMobile(),this.userStore=(0,Ue.k)()},beforeUnmount(){window.removeEventListener("resize",this.updateMobile)},methods:{updateMobile(){this.isMobile=window.innerWidth<768,this.isMobile&&""===this.activeSection&&(this.activeSection=null)},toggleSection(e){this.activeSection=e},onAvatarChange(e){const t=e.target.files[0];if(!t)return;const l=new FileReader;l.onload=()=>{this.userStore.setAvatar(this.currentUser,l.result)},l.readAsDataURL(t)},clearBg(){this.$emit("update:bgSrc",""),this.$emit("update:bgOpacity",1),this.$emit("update:bgBlur",0),this.draftBgSrc="",this.draftOpacity=1,this.draftBlur=0},cancelBg(){this.$emit("update:bgSrc",this.origBgSrc),this.$emit("update:bgOpacity",this.origOpacity),this.$emit("update:bgBlur",this.origBlur),this.showBgModal=!1},confirmBg(){this.showBgModal=!1},confirmRename(){this.$emit("update:localDisplayName",this.renameDraft.trim()),this.showRenameModal=!1},emitAddUid(){const e=(this.newAdminUid||"").trim();e?this.allowedUids.includes(e)?alert(`UID ${e} 已在白名单中`):(this.$emit("add-allowed-uid",e),this.newAdminUid=""):alert("请输入有效 UID")},onBgUpload(e){const t=e.target.files[0];if(!t)return;const l=new FileReader;l.onload=e=>{this.draftBgSrc=e.target.result},l.readAsDataURL(t)}}},et=(0,de.A)(Ze,[["render",se],["__scopeId","data-v-7eede528"]]),tt=et;var lt=l(85185),at=l(50953);const it="217122260",st={__name:"SettingsPage",setup(e){const t=[{id:"none",name:"不佩戴"},{id:"best",name:"最好的大佬"},{id:"catgirl",name:"你才是猫娘"}],l=(0,Ue.k)(),i=(0,a.EW)((()=>l.currentUser)),s=(0,at.KR)(localStorage.getItem("displayName_"+(i.value||""))||""),o=(0,at.KR)(localStorage.getItem("theme")||"dark"),n=(0,at.KR)(localStorage.getItem("bgSrc")||""),d=(0,at.KR)(parseFloat(localStorage.getItem("bgOpacity")||"0.35")),r=(0,at.KR)(parseInt(localStorage.getItem("bgBlur")||"4",10)),c=(0,at.KR)(localStorage.getItem("imageInsertMode")||"preview"),u=(0,at.KR)(JSON.parse(localStorage.getItem("llmEnabled")||"true")),p=(0,at.KR)(localStorage.getItem("wear_"+(i.value||""))||"none"),m=(0,at.KR)(JSON.parse(localStorage.getItem("cm_allowedUids")||"[]"));(0,at.KR)("");async function g(){if(!i.value)return void alert("当前无登录用户，无法修改密码");const e=i.value,t=`cred_${e}`,l=localStorage.getItem(t);if(!l)return void alert("请先登录并设置密码");const a=window.prompt("请输入旧密码：");if(null===a)return;const{hash:s,salt:o,iter:n}=JSON.parse(l),d=await(0,lt.wN)(a,o,n);if(d!==s)return void alert("旧密码不正确！");const r=window.prompt("请输入新密码（最少4位）：");if(null===r)return;if(r.length<4)return void alert("新密码长度至少4位！");const c=window.prompt("请再次输入新密码：");if(null===c)return;if(c!==r)return void alert("两次输入的新密码不一致！");const u=await(0,lt.wN)(r,o,n);localStorage.setItem(t,JSON.stringify({hash:u,salt:o,iter:n})),alert("密码修改成功！")}function k(){const e=t.map((e=>e.id)).join(" / "),l=window.prompt(`请输入要佩戴的勋章 ID（可选 ${e}）：`,p.value);null!==l&&(t.some((e=>e.id===l))?(p.value=l,alert(`已将勋章设置为：${l}`)):alert("无效的勋章 ID"))}function v(e){isAdmin.value?e&&window.confirm(`将清除 UID ${e} 的本地密码，下次登录需重设？`)&&(localStorage.removeItem(`cred_${e}`),localStorage.removeItem(`salt_${e}`),alert(`已清除 UID ${e} 的本地密码`)):alert("只有管理员才能重置密码")}return(0,a.wB)(o,(e=>{document.body.classList.toggle("dark","dark"===e),localStorage.setItem("theme",e)})),(0,a.wB)(n,(e=>{localStorage.setItem("bgSrc",e)})),(0,a.wB)(d,(e=>{localStorage.setItem("bgOpacity",e.toString())})),(0,a.wB)(r,(e=>{localStorage.setItem("bgBlur",e.toString())})),(0,a.wB)(c,(e=>{localStorage.setItem("imageInsertMode",e)})),(0,a.wB)(u,(e=>{localStorage.setItem("llmEnabled",JSON.stringify(e))})),(0,a.wB)(s,(e=>{i.value&&(localStorage.setItem("displayName_"+i.value,e.trim()),l.setDisplayName(i.value,e.trim()))})),(0,a.wB)(p,(e=>{i.value&&(localStorage.setItem("wear_"+i.value,e),l.setBadge(i.value,e))})),(0,a.wB)(m,(e=>{localStorage.setItem("cm_allowedUids",JSON.stringify(e))})),(e,l)=>((0,a.uX)(),(0,a.Wv)(tt,{theme:o.value,"onUpdate:theme":l[0]||(l[0]=e=>o.value=e),bgSrc:n.value,"onUpdate:bgSrc":l[1]||(l[1]=e=>n.value=e),bgOpacity:d.value,"onUpdate:bgOpacity":l[2]||(l[2]=e=>d.value=e),bgBlur:r.value,"onUpdate:bgBlur":l[3]||(l[3]=e=>r.value=e),imageInsertMode:c.value,"onUpdate:imageInsertMode":l[4]||(l[4]=e=>c.value=e),llmEnabled:u.value,"onUpdate:llmEnabled":l[5]||(l[5]=e=>u.value=e),localDisplayName:s.value,"onUpdate:localDisplayName":l[6]||(l[6]=e=>s.value=e),selectedBadge:p.value,"onUpdate:selectedBadge":l[7]||(l[7]=e=>p.value=e),allowedBadges:t,allowedUids:m.value,currentUser:i.value,adminUid:it,onOpenPasswordModal:g,onOpenBadgeModal:k,onResetPassword:v,onAddAllowedUid:e.addAllowedUid,onRemoveAllowedUid:e.removeAllowedUid,onOpenAdminPwdModal:e.openAdminPwdModal},null,8,["theme","bgSrc","bgOpacity","bgBlur","imageInsertMode","llmEnabled","localDisplayName","selectedBadge","allowedUids","currentUser","onAddAllowedUid","onRemoveAllowedUid","onOpenAdminPwdModal"]))}},ot=(0,de.A)(st,[["__scopeId","data-v-400a22a3"]]),nt=ot}}]);
//# sourceMappingURL=694.9be6be88.js.map