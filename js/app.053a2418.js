(()=>{"use strict";var e={185:(e,t,a)=>{async function r(e,t,a=1e5){const r=new TextEncoder,o=await crypto.subtle.importKey("raw",r.encode(e),{name:"PBKDF2"},!1,["deriveBits"]),n=await crypto.subtle.deriveBits({name:"PBKDF2",salt:r.encode(t),iterations:a,hash:"SHA-256"},o,256);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}a.d(t,{wN:()=>r})},255:(e,t,a)=>{var r=a(810),o=a(751),n=a(641);function l(e,t,a,r,o,l){const s=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.Wv)(s)}const s={name:"App"};var u=a(262);const i=(0,u.A)(s,[["render",l]]),c=i;var d=a(33),p=a(468),m=a(953),v=a(220);const g={class:"app-header"},h={class:"header-left"},f={class:"header-right"},b=["src"],k={class:"nav-dropdown"},y={__name:"HeaderNav",props:{title:{type:String,required:!0},avatar:{type:String,required:!0}},emits:["toggle-sidebar","refresh","search","post","notify","ai","settings"],setup(e,{emit:t}){const a=t,r=(0,m.KR)(""),l=(0,m.KR)(!1);function s(){a("search",r.value)}const u=(0,p.k)(),i=(0,v.rd)();function c(){u.logout(),i.push({name:"Login"})}function y(){l.value=!1,i.push("/settings")}return(t,a)=>((0,n.uX)(),(0,n.CE)("header",g,[(0,n.Lk)("div",h,[(0,n.Lk)("button",{class:"icon-btn hamburger",onClick:a[0]||(a[0]=e=>t.$emit("toggle-sidebar")),"aria-label":"切换侧栏"},a[9]||(a[9]=[(0,n.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,n.Lk)("path",{d:"M4 6h16M4 12h16M4 18h16"})],-1)])),(0,n.Lk)("span",{class:"logo",onClick:a[1]||(a[1]=e=>t.$emit("refresh"))},(0,d.v_)(e.title),1),(0,n.Lk)("button",{class:"icon-btn home-btn",onClick:a[2]||(a[2]=e=>t.$emit("refresh")),"aria-label":"主页"},a[10]||(a[10]=[(0,n.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,n.Lk)("path",{d:"M3 12l9-9 9 9M4 10v10h6v-6h4v6h6V10"})],-1)]))]),(0,n.Lk)("form",{class:"header-center search-form",onSubmit:(0,o.D$)(s,["prevent"])},[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>r.value=e),class:"search-input",placeholder:"Search…","aria-label":"搜索"},null,512),[[o.Jo,r.value]]),a[11]||(a[11]=(0,n.Lk)("button",{type:"submit",class:"icon-btn","aria-label":"搜索"},[(0,n.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,n.Lk)("circle",{cx:"11",cy:"11",r:"8"}),(0,n.Lk)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})])],-1))],32),(0,n.Lk)("div",f,[(0,n.Lk)("button",{class:"icon-btn",onClick:a[4]||(a[4]=e=>t.$emit("post")),"aria-label":"投稿"},a[12]||(a[12]=[(0,n.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,n.Lk)("path",{d:"M12 4v16M20 12H4"})],-1)])),(0,n.Lk)("button",{class:"icon-btn",onClick:a[5]||(a[5]=e=>t.$emit("notify")),"aria-label":"通知"},a[13]||(a[13]=[(0,n.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,n.Lk)("path",{d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11\n                   a6 6 0 0 0-5-5.917V5\n                   a2 2 0 1 0-4 0v.083\n                   A6 6 0 0 0 4 11v3.159\n                   c0 .538-.214 1.055-.595 1.436L2 17h5"}),(0,n.Lk)("path",{d:"M12 21a2 2 0 0 0 2-2H10a2 2 0 0 0 2 2z"})],-1)])),(0,n.Lk)("button",{class:"icon-btn",onClick:a[6]||(a[6]=e=>t.$emit("ai")),"aria-label":"AI 助手"},a[14]||(a[14]=[(0,n.Fv)('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#FFF" stroke-width="2.5" data-v-d00109d0><path d="M8 16l4-8 4 8" data-v-d00109d0></path><path d="M9 16.5l4-8 4 8" stroke-opacity=".2" data-v-d00109d0></path><line x1="10" y1="12" x2="14" y2="12" data-v-d00109d0></line><line x1="17" y1="8" x2="17" y2="16" data-v-d00109d0></line><line x1="17.6" y1="8.6" x2="17.6" y2="16.6" stroke-opacity=".2" data-v-d00109d0></line></svg>',1)])),(0,n.Lk)("div",{class:"nav-avatar",onMouseenter:a[7]||(a[7]=e=>l.value=!0),onMouseleave:a[8]||(a[8]=e=>l.value=!1)},[(0,n.Lk)("img",{src:e.avatar,class:"avatar-img",alt:"avatar"},null,8,b),(0,n.bF)(o.eB,{name:"dropdown-fade"},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.Lk)("div",k,[(0,n.Lk)("button",{class:"dropdown-item",onClick:y},"设置"),a[15]||(a[15]=(0,n.Lk)("div",{class:"dropdown-divider"},null,-1)),(0,n.Lk)("button",{class:"dropdown-item",onClick:c}," 退出 ")],512),[[o.aG,l.value]])])),_:1})],32)])]))}},_=(0,u.A)(y,[["__scopeId","data-v-d00109d0"]]),w=_,C={viewBox:"0 0 24 24",class:"icon"},L={__name:"AlbumIcon",setup(e){return(e,t)=>((0,n.uX)(),(0,n.CE)("svg",C,t[0]||(t[0]=[(0,n.Lk)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1),(0,n.Lk)("circle",{cx:"9",cy:"9",r:"2",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1),(0,n.Lk)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},S=(0,u.A)(L,[["__scopeId","data-v-78572ae1"]]),M=S,A={viewBox:"0 0 24 24",class:"icon"},x={__name:"HomeIcon",setup(e){return(e,t)=>((0,n.uX)(),(0,n.CE)("svg",A,t[0]||(t[0]=[(0,n.Lk)("path",{d:"M3 12l9-9 9 9M4 10v10h6v-6h4v6h6V10",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},E=(0,u.A)(x,[["__scopeId","data-v-0410df9a"]]),I=E,X={viewBox:"0 0 24 24",class:"icon"},B={__name:"MomentsIcon",setup(e){return(e,t)=>((0,n.uX)(),(0,n.CE)("svg",X,t[0]||(t[0]=[(0,n.Lk)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1),(0,n.Lk)("path",{d:"M7 8h10M7 12h8M7 16h6",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},F=(0,u.A)(B,[["__scopeId","data-v-bf6083b8"]]),N=F,$={viewBox:"0 0 24 24",class:"icon"},O={__name:"PostIcon",setup(e){return(e,t)=>((0,n.uX)(),(0,n.CE)("svg",$,t[0]||(t[0]=[(0,n.Lk)("path",{d:"M12 4v16M20 12H4",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},R=(0,u.A)(O,[["__scopeId","data-v-c2a4305c"]]),T=R,U={__name:"Icon",props:{name:{type:String,required:!0}},setup(e){const t=e,a={home:I,moments:N,albums:M,post:T},r=(0,n.EW)((()=>a[t.name]||null));return(e,t)=>r.value?((0,n.uX)(),(0,n.Wv)((0,n.$y)(r.value),{key:0})):(0,n.Q3)("",!0)}},W=U,q=W,K={__name:"NavItem",props:{to:{type:String,required:!0},icon:{type:String,required:!0},label:{type:String,required:!0}},setup(e){const t=e,a=(0,v.rd)(),r=(0,v.lq)(),o=(0,n.EW)((()=>r.path===t.to));function l(){r.path!==t.to&&a.push(t.to)}return(t,a)=>((0,n.uX)(),(0,n.CE)("button",{class:(0,d.C4)(["nav-item",{active:o.value}]),onClick:l},[(0,n.bF)(q,{name:e.icon},null,8,["name"]),(0,n.Lk)("span",null,(0,d.v_)(e.label),1)],2))}},P=(0,u.A)(K,[["__scopeId","data-v-4466c212"]]),j=P,V={__name:"SideBar",props:{collapsed:{type:Boolean,default:!1}},setup(e){return(t,a)=>((0,n.uX)(),(0,n.CE)("aside",{class:(0,d.C4)(["app-sidebar",{collapsed:e.collapsed}])},[(0,n.bF)(j,{to:"/",icon:"home",label:"首页"}),(0,n.bF)(j,{to:"/moments",icon:"moments",label:"动态"}),(0,n.bF)(j,{to:"/albums",icon:"albums",label:"相册"}),(0,n.bF)(j,{to:"/editor",icon:"post",label:"投稿"})],2))}},D=(0,u.A)(V,[["__scopeId","data-v-74dcf506"]]),H=D,G={class:"shell"},Q={class:"body"},J={__name:"ShellLayout",setup(e){const t=(0,m.KR)(!0);function a(){window.location.reload()}function r(e){console.log("搜索",e)}return(e,o)=>{const l=(0,n.g2)("HeaderRightStuff"),s=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",G,[(0,n.bF)(w,{onToggleSidebar:o[0]||(o[0]=e=>t.value=!t.value),onRefresh:a,onSearch:r},{"right-extra":(0,n.k6)((()=>[(0,n.bF)(l)])),_:1}),(0,n.Lk)("div",Q,[(0,n.bF)(H,{collapsed:!t.value},null,8,["collapsed"]),(0,n.Lk)("main",{class:(0,d.C4)(["app-main",{"sidebar-collapsed":!t.value}])},[(0,n.bF)(s)],2)])])}}},z=(0,u.A)(J,[["__scopeId","data-v-71986a3f"]]),Y=z,Z={style:{padding:"24px"}};function ee(e,t){return(0,n.uX)(),(0,n.CE)("h2",Z,"AlbumsPage 占位")}const te={},ae=(0,u.A)(te,[["render",ee]]),re=ae,oe={style:{padding:"24px"}};function ne(e,t){return(0,n.uX)(),(0,n.CE)("h2",oe,"EditorPage 占位")}const le={},se=(0,u.A)(le,[["render",ne]]),ue=se,ie=["217122260","246490729"];function ce(){try{const e=localStorage.getItem("allowed_uids"),t=JSON.parse(e);if(Array.isArray(t))return t}catch(e){}return ie}var de=a(185);const pe=["disabled"],me={key:0},ve={__name:"Button",props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:t}){const a=e,r=t;function o(e){a.disabled||r("click",e)}return(t,a)=>((0,n.uX)(),(0,n.CE)("button",(0,n.v6)(t.$attrs,{class:"btn-atom",disabled:e.disabled,onClick:o}),[e.loading?((0,n.uX)(),(0,n.CE)("span",me,"请稍候...")):(0,n.RG)(t.$slots,"default",{key:1})],16,pe))}},ge=(0,u.A)(ve,[["__scopeId","data-v-2bbbde2c"]]),he=ge,fe={class:"error-message"},be={__name:"ErrorMessage",props:{message:{type:String,required:!0}},setup(e){return(t,a)=>((0,n.uX)(),(0,n.CE)("p",fe,(0,d.v_)(e.message),1))}},ke=(0,u.A)(be,[["__scopeId","data-v-3425be1b"]]),ye=ke,_e={__name:"AnimatedTitle",props:{text:{type:String,required:!0},speedFirst:{type:Number,default:120},speedMid:{type:Number,default:60},speedLast:{type:Number,default:40},fadeDuration:{type:Number,default:150},pauseDuration:{type:Number,default:150}},setup(e){const t=e,a=(0,m.KR)(""),r=(0,m.KR)(!1);let l;function s(e){a.value="",r.value=!0;let o=0;function n(){if(o<e.length){a.value+=e[o++];const r=1===o?t.speedFirst:o===e.length?t.speedLast:t.speedMid;l=setTimeout(n,r)}}n()}function u(e){r.value=!1,clearTimeout(l),setTimeout((()=>s(e)),t.fadeDuration+t.pauseDuration)}return(0,n.wB)((()=>t.text),(e=>u(e)),{immediate:!0}),(e,t)=>((0,n.uX)(),(0,n.Wv)(o.eB,{name:"fade-scale"},{default:(0,n.k6)((()=>[r.value?((0,n.uX)(),(0,n.CE)("h3",(0,n.v6)({key:0,class:"animated-title"},e.$attrs),[(0,n.eW)((0,d.v_)(a.value),1),t[0]||(t[0]=(0,n.Lk)("span",{class:"typing-cursor"},null,-1))],16)):(0,n.Q3)("",!0)])),_:1}))}},we=(0,u.A)(_e,[["__scopeId","data-v-e07500f0"]]),Ce=we,Le=["value","type","placeholder","maxlength","autocomplete"],Se={__name:"InputField",props:{modelValue:{type:String,required:!0},type:{type:String,default:"text"},placeholder:{type:String,default:""},maxlength:{type:[String,Number],default:255},autocomplete:{type:String,default:"off"},error:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const a=t;function r(e){a("update:modelValue",e.target.value)}return(t,a)=>((0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("input",{value:e.modelValue,type:e.type,placeholder:e.placeholder,maxlength:e.maxlength,autocomplete:e.autocomplete,onInput:r,class:(0,d.C4)(["input-field",{"has-error":e.error}])},null,42,Le)]))}},Me=(0,u.A)(Se,[["__scopeId","data-v-3ab8759a"]]),Ae=Me,xe={class:"form-group"},Ee={__name:"FormGroup",props:{value:{type:String,required:!0},type:{type:String,default:"text"},placeholder:{type:String,default:""},maxlength:{type:[String,Number],default:255},autocomplete:{type:String,default:"off"},errorMessage:{type:String,default:""}},emits:["update:value"],setup(e,{emit:t}){const a=t;return(t,r)=>((0,n.uX)(),(0,n.CE)("div",xe,[(0,n.bF)(Ae,{modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=e=>a("update:value",e)),type:e.type,placeholder:e.placeholder,maxlength:e.maxlength,autocomplete:e.autocomplete,error:!!e.errorMessage},null,8,["modelValue","type","placeholder","maxlength","autocomplete","error"]),e.errorMessage?((0,n.uX)(),(0,n.Wv)(ye,{key:0,message:e.errorMessage},null,8,["message"])):(0,n.Q3)("",!0)]))}},Ie=(0,u.A)(Ee,[["__scopeId","data-v-3632b377"]]),Xe=Ie,Be={class:"login-box"},Fe={__name:"LoginModal",props:{show:{type:Boolean,required:!0}},emits:{"login-success":e=>"string"===typeof e&&e},setup(e,{emit:t}){const a=e,r=t,l=(0,m.KR)(""),s=(0,m.KR)(""),u=(0,m.KR)("登录 Captured Moments"),i=(0,m.KR)(""),c=(0,m.KR)(!1),p=(0,m.KR)(0);let v=null;const g=(0,n.EW)((()=>`cred_${l.value.trim()}`)),h=(0,n.EW)((()=>{p.value;try{return JSON.parse(localStorage.getItem(g.value)||"null")}catch{return null}})),f=(0,n.EW)((()=>""!==l.value.trim()&&!h.value)),b=(0,n.EW)((()=>{const e=l.value.trim(),t=s.value;return e&&t.length>=(f.value?4:1)&&!c.value})),k=(0,n.EW)((()=>a.show));function y(e,t){if(e.length!==t.length)return!1;let a=0;for(let r=0;r<e.length;r++)a|=e.charCodeAt(r)^t.charCodeAt(r);return 0===a}function _(){const e=crypto.getRandomValues(new Uint8Array(8));return Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("")}async function w(){if(!b.value)return;const e=l.value.trim();if("217122260"===e)return sessionStorage.setItem("currentUser",e),r("login-success",e);c.value=!0;try{if(i.value="",!ce().includes(e))return void(i.value="用户不存在");let t=Number(sessionStorage.getItem(`fail_${e}`)||0);if(t>=10)return void(i.value="尝试过多，请稍后再试");if(h.value){const{hash:a,salt:r,iter:o=1e5}=h.value,n=await(0,de.wN)(s.value,r,o);if(!y(n,a))return sessionStorage.setItem(`fail_${e}`,++t),void(i.value="密码不正确，请重试");sessionStorage.removeItem(`fail_${e}`)}else{if(s.value.length<4)return void(i.value="密码长度至少4位");const e=_(),t=await(0,de.wN)(s.value,e);localStorage.setItem(g.value,JSON.stringify({hash:t,salt:e,iter:1e5})),p.value++}sessionStorage.setItem("currentUser",e),r("login-success",e)}catch(t){i.value=t.message||"系统错误"}finally{c.value=!1}}return(0,n.wB)(k,(e=>{e&&(l.value="",s.value="",i.value="",c.value=!1,p.value++)})),(0,n.xo)((()=>clearTimeout(v))),(e,t)=>((0,n.uX)(),(0,n.Wv)(o.eB,{name:"fade"},{default:(0,n.k6)((()=>[k.value?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"fullpage-login",onKeydown:t[2]||(t[2]=(0,o.jR)((0,o.D$)((e=>b.value&&w()),["prevent"]),["enter"])),tabindex:"0"},[(0,n.Lk)("div",Be,[(0,n.bF)(Ce,{text:u.value,class:"dark-title"},null,8,["text"]),(0,n.Lk)("form",{onSubmit:(0,o.D$)(w,["prevent"]),autocomplete:"on"},[(0,n.bF)(Xe,{value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e),placeholder:"请输入UID",errorMessage:i.value&&!h.value?i.value:""},null,8,["value","errorMessage"]),(0,n.bF)(Xe,{value:s.value,"onUpdate:value":t[1]||(t[1]=e=>s.value=e),type:"password",placeholder:f.value?"首次设置密码（建议至少4位）":"请输入密码",autocomplete:f.value?"new-password":"current-password",errorMessage:i.value&&h.value?i.value:""},null,8,["value","placeholder","autocomplete","errorMessage"]),i.value&&!f.value&&h.value?((0,n.uX)(),(0,n.Wv)(ye,{key:0,message:i.value},null,8,["message"])):(0,n.Q3)("",!0),(0,n.bF)(he,{type:"submit",disabled:!b.value||c.value,loading:c.value},{default:(0,n.k6)((()=>[(0,n.eW)((0,d.v_)(f.value?"设置并登录":"登录"),1)])),_:1},8,["disabled","loading"])],32)])],32)):(0,n.Q3)("",!0)])),_:1}))}},Ne=(0,u.A)(Fe,[["__scopeId","data-v-1b172b46"]]),$e=Ne,Oe={__name:"LoginPage",setup(e){const t=(0,v.rd)(),a=(0,v.lq)(),r=(0,p.k)();function o(e){r.login(e);const o=a.query.redirect||"/moments";t.replace(o)}return(e,t)=>((0,n.uX)(),(0,n.Wv)($e,{show:"",onLoginSuccess:o}))}},Re=Oe,Te=Re,Ue={__name:"LoadMoreButton",emits:["load"],setup(e){return(e,t)=>((0,n.uX)(),(0,n.CE)("button",{class:"btn-load-more",onClick:t[0]||(t[0]=t=>e.$emit("load"))},[(0,n.RG)(e.$slots,"default",{},(()=>[t[1]||(t[1]=(0,n.eW)("加载更多"))]))]))}},We=(0,u.A)(Ue,[["__scopeId","data-v-38169860"]]),qe=We,Ke={class:"actions"},Pe={__name:"PostActions",props:{views:Number,comments:Number},emits:["toggle-comments"],setup(e){return(t,a)=>((0,n.uX)(),(0,n.CE)("div",Ke,[a[2]||(a[2]=(0,n.Lk)("svg",{viewBox:"0 0 24 24"},[(0,n.Lk)("path",{d:"M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7z m0 12a5 5 0 110-10 5 5 0 010 10z"})],-1)),(0,n.Lk)("span",null,(0,d.v_)(e.views),1),((0,n.uX)(),(0,n.CE)("svg",{viewBox:"0 0 24 24",class:"comment-btn",onClick:a[0]||(a[0]=e=>t.$emit("toggle-comments"))},a[1]||(a[1]=[(0,n.Lk)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10z",fill:"none",stroke:"currentColor","stroke-width":"2"},null,-1)]))),(0,n.Lk)("span",null,(0,d.v_)(e.comments),1)]))}},je=(0,u.A)(Pe,[["__scopeId","data-v-b469224c"]]),Ve=je,De={class:"post-card"},He={class:"head"},Ge=["src"],Qe={class:"date"},Je=["innerHTML"],ze={__name:"PostCard",props:{avatarUrl:String,author:String,time:String,content:String},setup(e){return(t,a)=>((0,n.uX)(),(0,n.CE)("article",De,[(0,n.Lk)("header",He,[(0,n.Lk)("img",{src:e.avatarUrl,class:"avatar"},null,8,Ge),(0,n.Lk)("b",null,(0,d.v_)(e.author),1),(0,n.Lk)("small",Qe,(0,d.v_)(e.time),1)]),(0,n.Lk)("section",{class:"body",innerHTML:e.content},null,8,Je),(0,n.RG)(t.$slots,"images"),(0,n.RG)(t.$slots,"actions"),(0,n.RG)(t.$slots,"comments")]))}},Ye=(0,u.A)(ze,[["__scopeId","data-v-43e2250f"]]),Ze=Ye,et={class:"photos"},tt=["onClick"],at=["src"],rt={key:0,class:"thumb-overlay"},ot={__name:"PostImages",props:{imgs:Array},emits:["open"],setup(e){return(t,a)=>((0,n.uX)(),(0,n.CE)("div",et,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.imgs.slice(0,3),((a,r)=>((0,n.uX)(),(0,n.CE)("div",{key:r,class:"thumb",onClick:e=>t.$emit("open",r)},[(0,n.Lk)("img",{src:a},null,8,at),2===r&&e.imgs.length>3?((0,n.uX)(),(0,n.CE)("div",rt,[(0,n.Lk)("span",null,"+"+(0,d.v_)(e.imgs.length-3),1)])):(0,n.Q3)("",!0)],8,tt)))),128))]))}},nt=(0,u.A)(ot,[["__scopeId","data-v-08705c32"]]),lt=nt,st={__name:"MomentsList",props:{posts:Array,hasMore:Boolean},emits:["load-more","open-modal","toggle-comments"],setup(e,{emit:t}){const a=t;return(t,r)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.posts,(e=>((0,n.uX)(),(0,n.Wv)(Ze,{key:e.id,"avatar-url":e.avatar,author:e.author,time:e.time,content:e.content},{images:(0,n.k6)((()=>[(0,n.bF)(lt,{imgs:e.imgs,onOpen:t=>a("open-modal",{post:e,idx:t})},null,8,["imgs","onOpen"])])),actions:(0,n.k6)((()=>[(0,n.bF)(Ve,{views:e.views,comments:e.cmts.length,onToggleComments:t=>a("toggle-comments",e)},null,8,["views","comments","onToggleComments"])])),comments:(0,n.k6)((()=>[(0,n.RG)(t.$slots,"comments",{post:e})])),_:2},1032,["avatar-url","author","time","content"])))),128)),e.hasMore?((0,n.uX)(),(0,n.Wv)(qe,{key:0,onLoad:r[0]||(r[0]=e=>a("load-more"))})):(0,n.Q3)("",!0)],64))}},ut=st,it=ut,ct={__name:"MomentsPage",setup(e){const t=[{id:1,avatar:"https://placehold.co/40",author:"Alice",time:"刚刚",content:"<p>Hello</p>",imgs:[],views:0,cmts:[]}];return(e,a)=>((0,n.uX)(),(0,n.Wv)(it,{posts:t,hasMore:!1,onOpenModal:()=>{},onToggleComments:()=>{},onLoadMore:()=>{}}))}},dt=ct,pt=dt,mt=[{path:"/login",name:"Login",component:Te},{path:"/:pathMatch(.*)*",name:"not-found",component:()=>a.e(899).then(a.bind(a,899))},{path:"/",component:Y,meta:{requiresAuth:!0},children:[{path:"",redirect:"/moments"},{path:"moments",name:"Moments",component:pt},{path:"albums",name:"Albums",component:re},{path:"editor",name:"Editor",component:ue},{path:"settings",name:"Settings",component:()=>a.e(995).then(a.bind(a,995))},{path:"/settings/:section?",name:"Settings",component:()=>a.e(995).then(a.bind(a,995))}]}],vt=(0,v.aE)({history:(0,v.Bt)(),routes:mt});vt.beforeEach(((e,t,a)=>{const r=(0,p.k)();if(e.meta.requiresAuth&&!r.currentUser)return a({name:"Login",query:{redirect:e.fullPath}});a()}));const gt=vt,ht=(0,o.Ef)(c),ft=(0,r.Ey)();ht.use(gt),ht.use(ft),ht.mount("#app")},468:(e,t,a)=>{a.d(t,{k:()=>o});var r=a(810);const o=(0,r.nY)("user",{state:()=>({currentUser:localStorage.getItem("cm_currentUser")||null,avatarMap:JSON.parse(localStorage.getItem("cm_avatarMap")||"{}")}),getters:{isLoggedIn:e=>!!e.currentUser,getAvatar:e=>t=>{const a=e.avatarMap[t];return a&&a.length>0?a:"https://placehold.co/60"}},actions:{login(e){console.log("🔥 userStore.login called with",e),this.currentUser=e,localStorage.setItem("cm_currentUser",e)},logout(){this.currentUser=null,localStorage.removeItem("cm_currentUser")},setAvatar(e,t){this.avatarMap={...this.avatarMap,[e]:t},localStorage.setItem("cm_avatarMap",JSON.stringify(this.avatarMap))}}})}},t={};function a(r){var o=t[r];if(void 0!==o)return o.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,a),n.exports}a.m=e,(()=>{var e=[];a.O=(t,r,o,n)=>{if(!r){var l=1/0;for(c=0;c<e.length;c++){for(var[r,o,n]=e[c],s=!0,u=0;u<r.length;u++)(!1&n||l>=n)&&Object.keys(a.O).every((e=>a.O[e](r[u])))?r.splice(u--,1):(s=!1,n<l&&(l=n));if(s){e.splice(c--,1);var i=o();void 0!==i&&(t=i)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[r,o,n]}})(),(()=>{a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[]))})(),(()=>{a.u=e=>"js/"+e+"."+{899:"78b37777",995:"7facb193"}[e]+".js"})(),(()=>{a.miniCssF=e=>"css/"+e+"."+{899:"96c2e450",995:"dbf839c3"}[e]+".css"})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="my-vue-app:";a.l=(r,o,n,l)=>{if(e[r])e[r].push(o);else{var s,u;if(void 0!==n)for(var i=document.getElementsByTagName("script"),c=0;c<i.length;c++){var d=i[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+n){s=d;break}}s||(u=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+n),s.src=r),e[r]=[o];var p=(t,a)=>{s.onerror=s.onload=null,clearTimeout(m);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(a))),t)return t(a)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),u&&document.head.appendChild(s)}}})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{a.p="/CapturedMoments/"})(),(()=>{if("undefined"!==typeof document){var e=(e,t,r,o,n)=>{var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",a.nc&&(l.nonce=a.nc);var s=a=>{if(l.onerror=l.onload=null,"load"===a.type)o();else{var r=a&&a.type,s=a&&a.target&&a.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+r+": "+s+")");u.name="ChunkLoadError",u.code="CSS_CHUNK_LOAD_FAILED",u.type=r,u.request=s,l.parentNode&&l.parentNode.removeChild(l),n(u)}};return l.onerror=l.onload=s,l.href=t,r?r.parentNode.insertBefore(l,r.nextSibling):document.head.appendChild(l),l},t=(e,t)=>{for(var a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var o=a[r],n=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(n===e||n===t))return o}var l=document.getElementsByTagName("style");for(r=0;r<l.length;r++){o=l[r],n=o.getAttribute("data-href");if(n===e||n===t)return o}},r=r=>new Promise(((o,n)=>{var l=a.miniCssF(r),s=a.p+l;if(t(l,s))return o();e(r,s,null,o,n)})),o={524:0};a.f.miniCss=(e,t)=>{var a={899:1,995:1};o[e]?t.push(o[e]):0!==o[e]&&a[e]&&t.push(o[e]=r(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}}})(),(()=>{var e={524:0};a.f.j=(t,r)=>{var o=a.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var n=new Promise(((a,r)=>o=e[t]=[a,r]));r.push(o[2]=n);var l=a.p+a.u(t),s=new Error,u=r=>{if(a.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var n=r&&("load"===r.type?"missing":r.type),l=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+n+": "+l+")",s.name="ChunkLoadError",s.type=n,s.request=l,o[1](s)}};a.l(l,u,"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,r)=>{var o,n,[l,s,u]=r,i=0;if(l.some((t=>0!==e[t]))){for(o in s)a.o(s,o)&&(a.m[o]=s[o]);if(u)var c=u(a)}for(t&&t(r);i<l.length;i++)n=l[i],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},r=self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=a.O(void 0,[504],(()=>a(255)));r=a.O(r)})();
//# sourceMappingURL=app.053a2418.js.map