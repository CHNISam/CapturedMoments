(()=>{"use strict";var e={585:(e,t,a)=>{var o=a(810),r=a(751),l=a(641);function n(e,t,a,o,r,n){const s=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.Wv)(s)}const s={name:"App"};var u=a(262);const i=(0,u.A)(s,[["render",n]]),c=i;var d=a(33),p=a(953);const m={class:"app-header"},v={class:"header-left"},g={class:"header-right"},h=["src"],f={class:"nav-dropdown"},k={__name:"HeaderNav",props:{title:{type:String,required:!0},avatar:{type:String,required:!0}},emits:["toggle-sidebar","refresh","search","post","notify","ai","settings","logout"],setup(e,{emit:t}){const a=t,o=(0,p.KR)(""),n=(0,p.KR)(!1);function s(){a("search",o.value)}return(t,a)=>((0,l.uX)(),(0,l.CE)("header",m,[(0,l.Lk)("div",v,[(0,l.Lk)("button",{class:"icon-btn hamburger",onClick:a[0]||(a[0]=e=>t.$emit("toggle-sidebar")),"aria-label":"切换侧栏"},a[11]||(a[11]=[(0,l.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,l.Lk)("path",{d:"M4 6h16M4 12h16M4 18h16"})],-1)])),(0,l.Lk)("span",{class:"logo",onClick:a[1]||(a[1]=e=>t.$emit("refresh"))},(0,d.v_)(e.title),1),(0,l.Lk)("button",{class:"icon-btn home-btn",onClick:a[2]||(a[2]=e=>t.$emit("refresh")),"aria-label":"主页"},a[12]||(a[12]=[(0,l.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,l.Lk)("path",{d:"M3 12l9-9 9 9M4 10v10h6v-6h4v6h6V10"})],-1)]))]),(0,l.Lk)("form",{class:"header-center search-form",onSubmit:(0,r.D$)(s,["prevent"])},[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>o.value=e),class:"search-input",placeholder:"Search…","aria-label":"搜索"},null,512),[[r.Jo,o.value]]),a[13]||(a[13]=(0,l.Lk)("button",{type:"submit",class:"icon-btn","aria-label":"搜索"},[(0,l.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,l.Lk)("circle",{cx:"11",cy:"11",r:"8"}),(0,l.Lk)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})])],-1))],32),(0,l.Lk)("div",g,[(0,l.Lk)("button",{class:"icon-btn",onClick:a[4]||(a[4]=e=>t.$emit("post")),"aria-label":"投稿"},a[14]||(a[14]=[(0,l.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,l.Lk)("path",{d:"M12 4v16M20 12H4"})],-1)])),(0,l.Lk)("button",{class:"icon-btn",onClick:a[5]||(a[5]=e=>t.$emit("notify")),"aria-label":"通知"},a[15]||(a[15]=[(0,l.Lk)("svg",{viewBox:"0 0 24 24",stroke:"currentColor",fill:"none","stroke-width":"2"},[(0,l.Lk)("path",{d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11a6 6 0 0 0-5-5.917V5\n                   a2 2 0 1 0-4 0v.083A6 6 0 0 0 4 11v3.159\n                   c0 .538-.214 1.055-.595 1.436L2 17h5"}),(0,l.Lk)("path",{d:"M12 21a2 2 0 0 0 2-2H10a2 2 0 0 0 2 2z"})],-1)])),(0,l.Lk)("button",{class:"icon-btn",onClick:a[6]||(a[6]=e=>t.$emit("ai")),"aria-label":"AI 助手"},a[16]||(a[16]=[(0,l.Fv)('<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#FFF" stroke-width="2.5" data-v-6e9d33f0><path d="M8 16l4-8 4 8" data-v-6e9d33f0></path><path d="M9 16.5l4-8 4 8" stroke-opacity=".2" data-v-6e9d33f0></path><line x1="10" y1="12" x2="14" y2="12" data-v-6e9d33f0></line><line x1="17" y1="8" x2="17" y2="16" data-v-6e9d33f0></line><line x1="17.6" y1="8.6" x2="17.6" y2="16.6" stroke-opacity=".2" data-v-6e9d33f0></line></svg>',1)])),(0,l.Lk)("div",{class:"nav-avatar",onMouseenter:a[9]||(a[9]=e=>n.value=!0),onMouseleave:a[10]||(a[10]=e=>n.value=!1)},[(0,l.Lk)("img",{src:e.avatar,class:"avatar-img",alt:"avatar"},null,8,h),(0,l.bF)(r.eB,{name:"dropdown-fade"},{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("div",f,[(0,l.Lk)("button",{class:"dropdown-item",onClick:a[7]||(a[7]=e=>t.$emit("settings"))}," 设置 "),a[17]||(a[17]=(0,l.Lk)("div",{class:"dropdown-divider"},null,-1)),(0,l.Lk)("button",{class:"dropdown-item",onClick:a[8]||(a[8]=e=>t.$emit("logout"))}," 退出 ")],512),[[r.aG,n.value]])])),_:1})],32)])]))}},b=(0,u.A)(k,[["__scopeId","data-v-6e9d33f0"]]),y=b,_={viewBox:"0 0 24 24",class:"icon"},w={__name:"AlbumIcon",setup(e){return(e,t)=>((0,l.uX)(),(0,l.CE)("svg",_,t[0]||(t[0]=[(0,l.Lk)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1),(0,l.Lk)("circle",{cx:"9",cy:"9",r:"2",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1),(0,l.Lk)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},L=(0,u.A)(w,[["__scopeId","data-v-78572ae1"]]),C=L,S={viewBox:"0 0 24 24",class:"icon"},M={__name:"HomeIcon",setup(e){return(e,t)=>((0,l.uX)(),(0,l.CE)("svg",S,t[0]||(t[0]=[(0,l.Lk)("path",{d:"M3 12l9-9 9 9M4 10v10h6v-6h4v6h6V10",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},x=(0,u.A)(M,[["__scopeId","data-v-0410df9a"]]),A=x,I={viewBox:"0 0 24 24",class:"icon"},E={__name:"MomentsIcon",setup(e){return(e,t)=>((0,l.uX)(),(0,l.CE)("svg",I,t[0]||(t[0]=[(0,l.Lk)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1),(0,l.Lk)("path",{d:"M7 8h10M7 12h8M7 16h6",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},X=(0,u.A)(E,[["__scopeId","data-v-bf6083b8"]]),B=X,F={viewBox:"0 0 24 24",class:"icon"},$={__name:"PostIcon",setup(e){return(e,t)=>((0,l.uX)(),(0,l.CE)("svg",F,t[0]||(t[0]=[(0,l.Lk)("path",{d:"M12 4v16M20 12H4",stroke:"currentColor",fill:"none","stroke-width":"2"},null,-1)])))}},R=(0,u.A)($,[["__scopeId","data-v-c2a4305c"]]),W=R,O={__name:"Icon",props:{name:{type:String,required:!0}},setup(e){const t=e,a={home:A,moments:B,albums:C,post:W},o=(0,l.EW)((()=>a[t.name]||null));return(e,t)=>o.value?((0,l.uX)(),(0,l.Wv)((0,l.$y)(o.value),{key:0})):(0,l.Q3)("",!0)}},U=O,K=U;var q=a(220);const N={__name:"NavItem",props:{to:{type:String,required:!0},icon:{type:String,required:!0},label:{type:String,required:!0}},setup(e){const t=e,a=(0,q.rd)(),o=(0,q.lq)(),r=(0,l.EW)((()=>o.path===t.to));function n(){o.path!==t.to&&a.push(t.to)}return(t,a)=>((0,l.uX)(),(0,l.CE)("button",{class:(0,d.C4)(["nav-item",{active:r.value}]),onClick:n},[(0,l.bF)(K,{name:e.icon},null,8,["name"]),(0,l.Lk)("span",null,(0,d.v_)(e.label),1)],2))}},T=(0,u.A)(N,[["__scopeId","data-v-4466c212"]]),V=T,P={__name:"SideBar",props:{collapsed:{type:Boolean,default:!1}},setup(e){return(t,a)=>((0,l.uX)(),(0,l.CE)("aside",{class:(0,d.C4)(["app-sidebar",{collapsed:e.collapsed}])},[(0,l.bF)(V,{to:"/",icon:"home",label:"首页"}),(0,l.bF)(V,{to:"/moments",icon:"moments",label:"动态"}),(0,l.bF)(V,{to:"/albums",icon:"albums",label:"相册"}),(0,l.bF)(V,{to:"/editor",icon:"post",label:"投稿"})],2))}},H=(0,u.A)(P,[["__scopeId","data-v-74dcf506"]]),D=H,j={class:"shell"},G={class:"body"},Q={__name:"ShellLayout",setup(e){const t=(0,p.KR)(!0);function a(){window.location.reload()}function o(e){console.log("搜索",e)}return(e,r)=>{const n=(0,l.g2)("HeaderRightStuff"),s=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",j,[(0,l.bF)(y,{onToggleSidebar:r[0]||(r[0]=e=>t.value=!t.value),onRefresh:a,onSearch:o},{"right-extra":(0,l.k6)((()=>[(0,l.bF)(n)])),_:1}),(0,l.Lk)("div",G,[(0,l.bF)(D,{collapsed:!t.value},null,8,["collapsed"]),(0,l.Lk)("main",{class:(0,d.C4)(["app-main",{"sidebar-collapsed":!t.value}])},[(0,l.bF)(s)],2)])])}}},J=(0,u.A)(Q,[["__scopeId","data-v-71986a3f"]]),z=J,Y=(0,o.nY)("user",{state:()=>({currentUser:localStorage.getItem("cm_currentUser")||null,avatarMap:JSON.parse(localStorage.getItem("cm_avatarMap")||"{}")}),getters:{isLoggedIn:e=>!!e.currentUser,getAvatar:e=>t=>{const a=e.avatarMap[t];return a&&a.length>0?a:"https://placehold.co/60"}},actions:{login(e){console.log("🔥 userStore.login called with",e),this.currentUser=e,localStorage.setItem("cm_currentUser",e)},logout(){this.currentUser=null,localStorage.removeItem("cm_currentUser")},setAvatar(e,t){this.avatarMap={...this.avatarMap,[e]:t},localStorage.setItem("cm_avatarMap",JSON.stringify(this.avatarMap))}}}),Z={style:{padding:"24px"}};function ee(e,t){return(0,l.uX)(),(0,l.CE)("h2",Z,"AlbumsPage 占位")}const te={},ae=(0,u.A)(te,[["render",ee]]),oe=ae,re={style:{padding:"24px"}};function le(e,t){return(0,l.uX)(),(0,l.CE)("h2",re,"EditorPage 占位")}const ne={},se=(0,u.A)(ne,[["render",le]]),ue=se,ie=["217122260","246490729"];function ce(){try{const e=localStorage.getItem("allowed_uids"),t=JSON.parse(e);if(Array.isArray(t))return t}catch(e){}return ie}async function de(e,t,a=1e5){const o=new TextEncoder,r=await crypto.subtle.importKey("raw",o.encode(e),{name:"PBKDF2"},!1,["deriveBits"]),l=await crypto.subtle.deriveBits({name:"PBKDF2",salt:o.encode(t),iterations:a,hash:"SHA-256"},r,256);return Array.from(new Uint8Array(l)).map((e=>e.toString(16).padStart(2,"0"))).join("")}const pe=["disabled"],me={key:0},ve={__name:"Button",props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:t}){const a=e,o=t;function r(e){a.disabled||o("click",e)}return(t,a)=>((0,l.uX)(),(0,l.CE)("button",(0,l.v6)(t.$attrs,{class:"btn-atom",disabled:e.disabled,onClick:r}),[e.loading?((0,l.uX)(),(0,l.CE)("span",me,"请稍候...")):(0,l.RG)(t.$slots,"default",{key:1})],16,pe))}},ge=(0,u.A)(ve,[["__scopeId","data-v-2bbbde2c"]]),he=ge,fe={class:"error-message"},ke={__name:"ErrorMessage",props:{message:{type:String,required:!0}},setup(e){return(t,a)=>((0,l.uX)(),(0,l.CE)("p",fe,(0,d.v_)(e.message),1))}},be=(0,u.A)(ke,[["__scopeId","data-v-3425be1b"]]),ye=be,_e={__name:"AnimatedTitle",props:{text:{type:String,required:!0},speedFirst:{type:Number,default:120},speedMid:{type:Number,default:60},speedLast:{type:Number,default:40},fadeDuration:{type:Number,default:150},pauseDuration:{type:Number,default:150}},setup(e){const t=e,a=(0,p.KR)(""),o=(0,p.KR)(!1);let n;function s(e){a.value="",o.value=!0;let r=0;function l(){if(r<e.length){a.value+=e[r++];const o=1===r?t.speedFirst:r===e.length?t.speedLast:t.speedMid;n=setTimeout(l,o)}}l()}function u(e){o.value=!1,clearTimeout(n),setTimeout((()=>s(e)),t.fadeDuration+t.pauseDuration)}return(0,l.wB)((()=>t.text),(e=>u(e)),{immediate:!0}),(e,t)=>((0,l.uX)(),(0,l.Wv)(r.eB,{name:"fade-scale"},{default:(0,l.k6)((()=>[o.value?((0,l.uX)(),(0,l.CE)("h3",(0,l.v6)({key:0,class:"animated-title"},e.$attrs),[(0,l.eW)((0,d.v_)(a.value),1),t[0]||(t[0]=(0,l.Lk)("span",{class:"typing-cursor"},null,-1))],16)):(0,l.Q3)("",!0)])),_:1}))}},we=(0,u.A)(_e,[["__scopeId","data-v-e07500f0"]]),Le=we,Ce=["value","type","placeholder","maxlength","autocomplete"],Se={__name:"InputField",props:{modelValue:{type:String,required:!0},type:{type:String,default:"text"},placeholder:{type:String,default:""},maxlength:{type:[String,Number],default:255},autocomplete:{type:String,default:"off"},error:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const a=t;function o(e){a("update:modelValue",e.target.value)}return(t,a)=>((0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("input",{value:e.modelValue,type:e.type,placeholder:e.placeholder,maxlength:e.maxlength,autocomplete:e.autocomplete,onInput:o,class:(0,d.C4)(["input-field",{"has-error":e.error}])},null,42,Ce)]))}},Me=(0,u.A)(Se,[["__scopeId","data-v-3ab8759a"]]),xe=Me,Ae={class:"form-group"},Ie={__name:"FormGroup",props:{value:{type:String,required:!0},type:{type:String,default:"text"},placeholder:{type:String,default:""},maxlength:{type:[String,Number],default:255},autocomplete:{type:String,default:"off"},errorMessage:{type:String,default:""}},emits:["update:value"],setup(e,{emit:t}){const a=t;return(t,o)=>((0,l.uX)(),(0,l.CE)("div",Ae,[(0,l.bF)(xe,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=e=>a("update:value",e)),type:e.type,placeholder:e.placeholder,maxlength:e.maxlength,autocomplete:e.autocomplete,error:!!e.errorMessage},null,8,["modelValue","type","placeholder","maxlength","autocomplete","error"]),e.errorMessage?((0,l.uX)(),(0,l.Wv)(ye,{key:0,message:e.errorMessage},null,8,["message"])):(0,l.Q3)("",!0)]))}},Ee=(0,u.A)(Ie,[["__scopeId","data-v-3632b377"]]),Xe=Ee,Be={class:"login-box"},Fe={__name:"LoginModal",props:{show:{type:Boolean,required:!0}},emits:{"login-success":e=>"string"===typeof e&&e},setup(e,{emit:t}){const a=e,o=t,n=(0,p.KR)(""),s=(0,p.KR)(""),u=(0,p.KR)("登录 Captured Moments"),i=(0,p.KR)(""),c=(0,p.KR)(!1),m=(0,p.KR)(0);let v=null;const g=(0,l.EW)((()=>`cred_${n.value.trim()}`)),h=(0,l.EW)((()=>{m.value;try{return JSON.parse(localStorage.getItem(g.value)||"null")}catch{return null}})),f=(0,l.EW)((()=>""!==n.value.trim()&&!h.value)),k=(0,l.EW)((()=>{const e=n.value.trim(),t=s.value;return e&&t.length>=(f.value?4:1)&&!c.value})),b=(0,l.EW)((()=>a.show));function y(e,t){if(e.length!==t.length)return!1;let a=0;for(let o=0;o<e.length;o++)a|=e.charCodeAt(o)^t.charCodeAt(o);return 0===a}function _(){const e=crypto.getRandomValues(new Uint8Array(8));return Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("")}async function w(){if(!k.value)return;const e=n.value.trim();if("217122260"===e)return sessionStorage.setItem("currentUser",e),o("login-success",e);c.value=!0;try{if(i.value="",!ce().includes(e))return void(i.value="用户不存在");let t=Number(sessionStorage.getItem(`fail_${e}`)||0);if(t>=10)return void(i.value="尝试过多，请稍后再试");if(h.value){const{hash:a,salt:o,iter:r=1e5}=h.value,l=await de(s.value,o,r);if(!y(l,a))return sessionStorage.setItem(`fail_${e}`,++t),void(i.value="密码不正确，请重试");sessionStorage.removeItem(`fail_${e}`)}else{if(s.value.length<4)return void(i.value="密码长度至少4位");const e=_(),t=await de(s.value,e);localStorage.setItem(g.value,JSON.stringify({hash:t,salt:e,iter:1e5})),m.value++}sessionStorage.setItem("currentUser",e),o("login-success",e)}catch(t){i.value=t.message||"系统错误"}finally{c.value=!1}}return(0,l.wB)(b,(e=>{e&&(n.value="",s.value="",i.value="",c.value=!1,m.value++)})),(0,l.xo)((()=>clearTimeout(v))),(e,t)=>((0,l.uX)(),(0,l.Wv)(r.eB,{name:"fade"},{default:(0,l.k6)((()=>[b.value?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"fullpage-login",onKeydown:t[2]||(t[2]=(0,r.jR)((0,r.D$)((e=>k.value&&w()),["prevent"]),["enter"])),tabindex:"0"},[(0,l.Lk)("div",Be,[(0,l.bF)(Le,{text:u.value,class:"dark-title"},null,8,["text"]),(0,l.Lk)("form",{onSubmit:(0,r.D$)(w,["prevent"]),autocomplete:"on"},[(0,l.bF)(Xe,{value:n.value,"onUpdate:value":t[0]||(t[0]=e=>n.value=e),placeholder:"请输入UID",errorMessage:i.value&&!h.value?i.value:""},null,8,["value","errorMessage"]),(0,l.bF)(Xe,{value:s.value,"onUpdate:value":t[1]||(t[1]=e=>s.value=e),type:"password",placeholder:f.value?"首次设置密码（建议至少4位）":"请输入密码",autocomplete:f.value?"new-password":"current-password",errorMessage:i.value&&h.value?i.value:""},null,8,["value","placeholder","autocomplete","errorMessage"]),i.value&&!f.value&&h.value?((0,l.uX)(),(0,l.Wv)(ye,{key:0,message:i.value},null,8,["message"])):(0,l.Q3)("",!0),(0,l.bF)(he,{type:"submit",disabled:!k.value||c.value,loading:c.value},{default:(0,l.k6)((()=>[(0,l.eW)((0,d.v_)(f.value?"设置并登录":"登录"),1)])),_:1},8,["disabled","loading"])],32)])],32)):(0,l.Q3)("",!0)])),_:1}))}},$e=(0,u.A)(Fe,[["__scopeId","data-v-1b172b46"]]),Re=$e,We={__name:"LoginPage",setup(e){const t=(0,q.rd)(),a=(0,q.lq)(),o=Y();function r(e){o.login(e);const r=a.query.redirect||"/moments";t.replace(r)}return(e,t)=>((0,l.uX)(),(0,l.Wv)(Re,{show:"",onLoginSuccess:r}))}},Oe=We,Ue=Oe,Ke={__name:"LoadMoreButton",emits:["load"],setup(e){return(e,t)=>((0,l.uX)(),(0,l.CE)("button",{class:"btn-load-more",onClick:t[0]||(t[0]=t=>e.$emit("load"))},[(0,l.RG)(e.$slots,"default",{},(()=>[t[1]||(t[1]=(0,l.eW)("加载更多"))]))]))}},qe=(0,u.A)(Ke,[["__scopeId","data-v-38169860"]]),Ne=qe,Te={class:"actions"},Ve={__name:"PostActions",props:{views:Number,comments:Number},emits:["toggle-comments"],setup(e){return(t,a)=>((0,l.uX)(),(0,l.CE)("div",Te,[a[2]||(a[2]=(0,l.Lk)("svg",{viewBox:"0 0 24 24"},[(0,l.Lk)("path",{d:"M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7z m0 12a5 5 0 110-10 5 5 0 010 10z"})],-1)),(0,l.Lk)("span",null,(0,d.v_)(e.views),1),((0,l.uX)(),(0,l.CE)("svg",{viewBox:"0 0 24 24",class:"comment-btn",onClick:a[0]||(a[0]=e=>t.$emit("toggle-comments"))},a[1]||(a[1]=[(0,l.Lk)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10z",fill:"none",stroke:"currentColor","stroke-width":"2"},null,-1)]))),(0,l.Lk)("span",null,(0,d.v_)(e.comments),1)]))}},Pe=(0,u.A)(Ve,[["__scopeId","data-v-b469224c"]]),He=Pe,De={class:"post-card"},je={class:"head"},Ge=["src"],Qe={class:"date"},Je=["innerHTML"],ze={__name:"PostCard",props:{avatarUrl:String,author:String,time:String,content:String},setup(e){return(t,a)=>((0,l.uX)(),(0,l.CE)("article",De,[(0,l.Lk)("header",je,[(0,l.Lk)("img",{src:e.avatarUrl,class:"avatar"},null,8,Ge),(0,l.Lk)("b",null,(0,d.v_)(e.author),1),(0,l.Lk)("small",Qe,(0,d.v_)(e.time),1)]),(0,l.Lk)("section",{class:"body",innerHTML:e.content},null,8,Je),(0,l.RG)(t.$slots,"images"),(0,l.RG)(t.$slots,"actions"),(0,l.RG)(t.$slots,"comments")]))}},Ye=(0,u.A)(ze,[["__scopeId","data-v-43e2250f"]]),Ze=Ye,et={class:"photos"},tt=["onClick"],at=["src"],ot={key:0,class:"thumb-overlay"},rt={__name:"PostImages",props:{imgs:Array},emits:["open"],setup(e){return(t,a)=>((0,l.uX)(),(0,l.CE)("div",et,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.imgs.slice(0,3),((a,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o,class:"thumb",onClick:e=>t.$emit("open",o)},[(0,l.Lk)("img",{src:a},null,8,at),2===o&&e.imgs.length>3?((0,l.uX)(),(0,l.CE)("div",ot,[(0,l.Lk)("span",null,"+"+(0,d.v_)(e.imgs.length-3),1)])):(0,l.Q3)("",!0)],8,tt)))),128))]))}},lt=(0,u.A)(rt,[["__scopeId","data-v-08705c32"]]),nt=lt,st={__name:"MomentsList",props:{posts:Array,hasMore:Boolean},emits:["load-more","open-modal","toggle-comments"],setup(e,{emit:t}){const a=t;return(t,o)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.posts,(e=>((0,l.uX)(),(0,l.Wv)(Ze,{key:e.id,"avatar-url":e.avatar,author:e.author,time:e.time,content:e.content},{images:(0,l.k6)((()=>[(0,l.bF)(nt,{imgs:e.imgs,onOpen:t=>a("open-modal",{post:e,idx:t})},null,8,["imgs","onOpen"])])),actions:(0,l.k6)((()=>[(0,l.bF)(He,{views:e.views,comments:e.cmts.length,onToggleComments:t=>a("toggle-comments",e)},null,8,["views","comments","onToggleComments"])])),comments:(0,l.k6)((()=>[(0,l.RG)(t.$slots,"comments",{post:e})])),_:2},1032,["avatar-url","author","time","content"])))),128)),e.hasMore?((0,l.uX)(),(0,l.Wv)(Ne,{key:0,onLoad:o[0]||(o[0]=e=>a("load-more"))})):(0,l.Q3)("",!0)],64))}},ut=st,it=ut,ct={__name:"MomentsPage",setup(e){const t=[{id:1,avatar:"https://placehold.co/40",author:"Alice",time:"刚刚",content:"<p>Hello</p>",imgs:[],views:0,cmts:[]}];return(e,a)=>((0,l.uX)(),(0,l.Wv)(it,{posts:t,hasMore:!1,onOpenModal:()=>{},onToggleComments:()=>{},onLoadMore:()=>{}}))}},dt=ct,pt=dt,mt=[{path:"/login",name:"Login",component:Ue},{path:"/",component:z,meta:{requiresAuth:!0},children:[{path:"",redirect:"/moments"},{path:"moments",name:"Moments",component:pt},{path:"albums",name:"Albums",component:oe},{path:"editor",name:"Editor",component:ue}]}],vt=(0,q.aE)({history:(0,q.Bt)(),routes:mt});vt.beforeEach(((e,t,a)=>{const o=Y();if(e.meta.requiresAuth&&!o.currentUser)return a({name:"Login",query:{redirect:e.fullPath}});a()}));const gt=vt,ht=(0,r.Ef)(c),ft=(0,o.Ey)();ht.use(gt),ht.use(ft),ht.mount("#app")}},t={};function a(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,a),l.exports}a.m=e,(()=>{var e=[];a.O=(t,o,r,l)=>{if(!o){var n=1/0;for(c=0;c<e.length;c++){for(var[o,r,l]=e[c],s=!0,u=0;u<o.length;u++)(!1&l||n>=l)&&Object.keys(a.O).every((e=>a.O[e](o[u])))?o.splice(u--,1):(s=!1,l<n&&(n=l));if(s){e.splice(c--,1);var i=r();void 0!==i&&(t=i)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[o,r,l]}})(),(()=>{a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={524:0};a.O.j=t=>0===e[t];var t=(t,o)=>{var r,l,[n,s,u]=o,i=0;if(n.some((t=>0!==e[t]))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(u)var c=u(a)}for(t&&t(o);i<n.length;i++)l=n[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(c)},o=self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=a.O(void 0,[504],(()=>a(585)));o=a.O(o)})();
//# sourceMappingURL=app.b4aee720.js.map